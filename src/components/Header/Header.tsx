import React, { useContext } from 'react';
import { UserContext } from '../../context/UserContext';
import { Link } from 'react-router-dom';
import { Dropdown } from './Dropdown/Dropdown';
import styled from 'styled-components';

const StyledHeader = styled.header`
    z-index: 5;
    display: grid;
    background-color: rgba(39, 35, 67, 0.301);
    backdrop-filter: blur(40px);
    padding: 1em 2em;
    grid-template-columns: 1fr minmax(200px, 2fr);
    align-items: center;
`;

const strokeChangeTime = '1s';
const StyledSvg = styled.svg`
    animation: fill 0.7s ease forwards 3.5s;
    path:nth-child(1) {
        stroke-dasharray: 170;
        stroke-dashoffset: 170;
        animation: line-anim 2s ease forwards 0.3s,
            stroke ${strokeChangeTime} ease forwards 3.5s;
    }
    path:nth-child(2) {
        stroke-dasharray: 66;
        stroke-dashoffset: 66;
        animation: line-anim 2s ease forwards 0.6s,
            stroke ${strokeChangeTime} ease forwards 3.5s;
    }
    path:nth-child(3) {
        stroke-dasharray: 120;
        stroke-dashoffset: 120;
        animation: line-anim 2s ease forwards 0.9s,
            stroke ${strokeChangeTime} ease forwards 3.5s;
    }
    path:nth-child(4) {
        stroke-dasharray: 192;
        stroke-dashoffset: 192;
        animation: line-anim 2s ease forwards 1.2s,
            stroke ${strokeChangeTime} ease forwards 3.5s;
    }
    path:nth-child(5) {
        stroke-dasharray: 116;
        stroke-dashoffset: 116;
        animation: line-anim 2s ease forwards 1.5s,
            stroke ${strokeChangeTime} ease forwards 3.5s;
    }

    @keyframes line-anim {
        to {
            stroke-dashoffset: 0;
        }
    }

    @keyframes fill {
        from {
            fill: transparent;
        }
        to {
            fill: ${(props) => props.theme.headline};
        }
    }

    @keyframes stroke {
        to {
            stroke: ${(props) => props.theme.headline};
        }
    }
`;

export const Header: React.FC = () => {
    const { user } = useContext(UserContext);
    return (
        <StyledHeader>
            <Link
                to="/blogs"
                style={{ textDecoration: 'none', color: 'inherit' }}
            >
                <StyledSvg
                    style={{ transform: 'translateY(6px)' }}
                    width="106"
                    height="43"
                    viewBox="0 0 106 43"
                    fill="none"
                    xmlns="http://www.w3.org/2000/svg"
                >
                    <path
                        className="path"
                        d="M15.5947 16.64C16.608 16.8 17.528 17.2134 18.3547 17.88C19.208 18.5467 19.8747 19.3734 20.3547 20.36C20.8613 21.3467 21.1147 22.4 21.1147 23.52C21.1147 24.9334 20.7547 26.2134 20.0347 27.36C19.3147 28.48 18.2613 29.3734 16.8747 30.04C15.5147 30.68 13.9013 31 12.0347 31H1.63467V3.12002H11.6347C13.528 3.12002 15.1413 3.44002 16.4747 4.08002C17.808 4.69336 18.808 5.53336 19.4747 6.60002C20.1413 7.66669 20.4747 8.86669 20.4747 10.2C20.4747 11.8534 20.0213 13.2267 19.1147 14.32C18.2347 15.3867 17.0613 16.16 15.5947 16.64ZM5.27467 15.16H11.3947C13.1013 15.16 14.4213 14.76 15.3547 13.96C16.288 13.16 16.7547 12.0534 16.7547 10.64C16.7547 9.22669 16.288 8.12002 15.3547 7.32002C14.4213 6.52002 13.0747 6.12002 11.3147 6.12002H5.27467V15.16ZM11.7147 28C13.528 28 14.9413 27.5734 15.9547 26.72C16.968 25.8667 17.4747 24.68 17.4747 23.16C17.4747 21.6134 16.9413 20.4 15.8747 19.52C14.808 18.6134 13.3813 18.16 11.5947 18.16H5.27467V28H11.7147Z"
                        stroke="white"
                        strokeWidth="1"
                        mask="url(#path-1-outside-1)"
                    />
                    <path
                        className="path"
                        d="M29.8059 1.40002V31H26.1659V1.40002H29.8059Z"
                        stroke="white"
                        strokeWidth="1"
                        mask="url(#path-1-outside-1)"
                    />
                    <path
                        className="path"
                        d="M45.5697 31.36C43.5163 31.36 41.6497 30.8934 39.9697 29.96C38.3163 29.0267 37.0097 27.7067 36.0497 26C35.1163 24.2667 34.6497 22.2667 34.6497 20C34.6497 17.76 35.1297 15.7867 36.0897 14.08C37.0763 12.3467 38.4097 11.0267 40.0897 10.12C41.7697 9.18669 43.6497 8.72002 45.7297 8.72002C47.8097 8.72002 49.6897 9.18669 51.3697 10.12C53.0497 11.0267 54.3697 12.3334 55.3297 14.04C56.3163 15.7467 56.8097 17.7334 56.8097 20C56.8097 22.2667 56.303 24.2667 55.2897 26C54.303 27.7067 52.9563 29.0267 51.2497 29.96C49.543 30.8934 47.6497 31.36 45.5697 31.36ZM45.5697 28.16C46.8763 28.16 48.103 27.8534 49.2497 27.24C50.3963 26.6267 51.3163 25.7067 52.0097 24.48C52.7297 23.2534 53.0897 21.76 53.0897 20C53.0897 18.24 52.743 16.7467 52.0497 15.52C51.3563 14.2934 50.4497 13.3867 49.3297 12.8C48.2097 12.1867 46.9963 11.88 45.6897 11.88C44.3563 11.88 43.1297 12.1867 42.0097 12.8C40.9163 13.3867 40.0363 14.2934 39.3697 15.52C38.703 16.7467 38.3697 18.24 38.3697 20C38.3697 21.7867 38.6897 23.2934 39.3297 24.52C39.9963 25.7467 40.8763 26.6667 41.9697 27.28C43.063 27.8667 44.263 28.16 45.5697 28.16Z"
                        stroke="white"
                        strokeWidth="1"
                        mask="url(#path-1-outside-1)"
                    />
                    <path
                        className="path"
                        d="M70.6356 8.72002C72.5289 8.72002 74.1823 9.13336 75.5956 9.96002C77.0356 10.7867 78.1023 11.8267 78.7956 13.08V9.08002H82.4756V31.48C82.4756 33.48 82.0489 35.2534 81.1956 36.8C80.3423 38.3734 79.1156 39.6 77.5156 40.48C75.9423 41.36 74.1023 41.8 71.9956 41.8C69.1156 41.8 66.7156 41.12 64.7956 39.76C62.8756 38.4 61.7423 36.5467 61.3956 34.2H64.9956C65.3956 35.5334 66.2223 36.6 67.4756 37.4C68.7289 38.2267 70.2356 38.64 71.9956 38.64C73.9956 38.64 75.6223 38.0134 76.8756 36.76C78.1556 35.5067 78.7956 33.7467 78.7956 31.48V26.88C78.0756 28.16 77.0089 29.2267 75.5956 30.08C74.1823 30.9334 72.5289 31.36 70.6356 31.36C68.6889 31.36 66.9156 30.88 65.3156 29.92C63.7423 28.96 62.5023 27.6134 61.5956 25.88C60.6889 24.1467 60.2356 22.1734 60.2356 19.96C60.2356 17.72 60.6889 15.76 61.5956 14.08C62.5023 12.3734 63.7423 11.0534 65.3156 10.12C66.9156 9.18669 68.6889 8.72002 70.6356 8.72002ZM78.7956 20C78.7956 18.3467 78.4623 16.9067 77.7956 15.68C77.1289 14.4534 76.2223 13.52 75.0756 12.88C73.9556 12.2134 72.7156 11.88 71.3556 11.88C69.9956 11.88 68.7556 12.2 67.6356 12.84C66.5156 13.48 65.6223 14.4134 64.9556 15.64C64.2889 16.8667 63.9556 18.3067 63.9556 19.96C63.9556 21.64 64.2889 23.1067 64.9556 24.36C65.6223 25.5867 66.5156 26.5334 67.6356 27.2C68.7556 27.84 69.9956 28.16 71.3556 28.16C72.7156 28.16 73.9556 27.84 75.0756 27.2C76.2223 26.5334 77.1289 25.5867 77.7956 24.36C78.4623 23.1067 78.7956 21.6534 78.7956 20Z"
                        stroke="white"
                        strokeWidth="1"
                        mask="url(#path-1-outside-1)"
                    />
                    <path
                        className="path"
                        d="M96.3869 31.36C94.7069 31.36 93.2002 31.08 91.8669 30.52C90.5335 29.9334 89.4802 29.1334 88.7069 28.12C87.9335 27.08 87.5069 25.8934 87.4269 24.56H91.1869C91.2935 25.6534 91.8002 26.5467 92.7069 27.24C93.6402 27.9334 94.8535 28.28 96.3469 28.28C97.7335 28.28 98.8269 27.9734 99.6269 27.36C100.427 26.7467 100.827 25.9734 100.827 25.04C100.827 24.08 100.4 23.3734 99.5469 22.92C98.6935 22.44 97.3735 21.9734 95.5869 21.52C93.9602 21.0934 92.6269 20.6667 91.5869 20.24C90.5735 19.7867 89.6935 19.1334 88.9469 18.28C88.2269 17.4 87.8669 16.2534 87.8669 14.84C87.8669 13.72 88.2002 12.6934 88.8669 11.76C89.5335 10.8267 90.4802 10.0934 91.7069 9.56002C92.9335 9.00002 94.3335 8.72002 95.9069 8.72002C98.3335 8.72002 100.294 9.33336 101.787 10.56C103.28 11.7867 104.08 13.4667 104.187 15.6H100.547C100.467 14.4534 100 13.5334 99.1469 12.84C98.3202 12.1467 97.2002 11.8 95.7869 11.8C94.4802 11.8 93.4402 12.08 92.6669 12.64C91.8935 13.2 91.5069 13.9334 91.5069 14.84C91.5069 15.56 91.7335 16.16 92.1869 16.64C92.6669 17.0934 93.2535 17.4667 93.9469 17.76C94.6669 18.0267 95.6535 18.3334 96.9069 18.68C98.4802 19.1067 99.7602 19.5334 100.747 19.96C101.734 20.36 102.574 20.9734 103.267 21.8C103.987 22.6267 104.36 23.7067 104.387 25.04C104.387 26.24 104.054 27.32 103.387 28.28C102.72 29.24 101.774 30 100.547 30.56C99.3469 31.0934 97.9602 31.36 96.3869 31.36Z"
                        stroke="white"
                        strokeWidth="1"
                        mask="url(#path-1-outside-1)"
                    />
                </StyledSvg>
            </Link>

            {user.isLogged ? (
                <Dropdown username={user.username} />
            ) : (
                <Link
                    to="/login"
                    style={{
                        textDecoration: 'none',
                        color: 'inherit',
                        justifySelf: 'end',
                    }}
                >
                    Login
                </Link>
            )}
        </StyledHeader>
    );
};
